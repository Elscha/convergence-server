version: 1
description: Initial Schema Creation
changes:

########## User Class ##########

  - type: CreateClass
    name: User
    properties: 
      - name: username
        orientType: String
        constraints:
          mandatory: true 
          notNull: true

      - name: email
        orientType: String
        constraints:
          mandatory: true 
          notNull: true
          
      - name: firstName
        orientType: String
        constraints:
          mandatory: true 
          notNull: true

      - name: lastName
        orientType: String
        constraints:
          mandatory: true 
          notNull: true

  - type: CreateIndex
    className: User
    name: User.username
    indexType: Unique
    properties: [username]

  - type: CreateIndex
    className: User
    name: User.email
    indexType: Unique
    properties: [email]
    
########## UserCredential Class ##########

  - type: CreateClass
    name: UserCredential
    properties: 
      - name: user
        orientType: Link
        classType: User
        constraints:
          mandatory: true 
          notNull: true

      - name: password
        orientType: String
        constraints:
          mandatory: true 
          notNull: true
          
  - type: CreateIndex
    className: UserCredential
    name: UserCredential.user
    indexType: Unique
    properties: [user]
    
########## UserAuthToken Class ##########

  - type: CreateClass
    name: UserAuthToken
    properties: 
      - name: user
        orientType: Link
        classType: User
        constraints:
          mandatory: true 
          notNull: true

      - name: token
        orientType: String
        constraints:
          mandatory: true 
          notNull: true
          
      - name: expireTime
        orientType: DateTime
        constraints:
          mandatory: true 
          notNull: true
          
########## Domain Class ##########

  - type: CreateClass
    name: Domain
    properties: 
      - name: namespace
        orientType: String
        constraints:
          mandatory: true 
          notNull: true
          
      - name: domainId
        orientType: String
        constraints: 
          mandatory: true
          notNull: true
          
      - name: displayName
        orientType: String
        constraints: 
          mandatory: true
          
      - name: owner
        orientType: Link
        classType: User
        constraints: 
          mandatory: true
          notNull: true
          
      - name: dbName
        orientType: String

      - name: dbUsername
        orientType: String
        
      - name: dbPassword
        orientType: String

      - name: status
        orientType: String
        constraints: 
          mandatory: true
          notNull: true
          
  - type: CreateIndex
    className: Domain
    name: Domain.dbName
    indexType: Unique
    properties: [dbName]

  - type: CreateIndex
    className: Domain
    name: Domain.namespace_domainId
    indexType: UniqueHashIndex
    properties: [namespace, domainId]
    
########## Registration Class ##########

  - type: CreateClass
    name: Registration
    properties: 
      - name: email
        orientType: String
        constraints:
          mandatory: true 
          notNull: true
          
      - name: fname
        orientType: String
        constraints: 
          mandatory: true
          notNull: true
          
      - name: lname
        orientType: String
        constraints: 
          mandatory: true
          notNull: true
          
      - name: reason
        orientType: String
        constraints: 
          mandatory: true
          notNull: true
          
      - name: token
        orientType: String
        constraints: 
          mandatory: true
          notNull: true
          
      - name: approved
        orientType: Boolean
        constraints: 
          mandatory: true
          notNull: true
          
  - type: CreateIndex
    className: Registration
    name: Registration.email
    indexType: Unique
    properties: [email]

  - type: CreateIndex
    className: Registration
    name: Registration.email_token
    indexType: Unique
    properties: [email, token]
    
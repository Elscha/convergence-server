version: 1
description: Initial Schema Creation
changes:

########## User Class ##########

  - type: CreateClass
    name: User
    properties: 
      - name: username
        type: String
        constraints:
          mandatory: true 
          notNull: true

      - name: email
        type: String
        constraints:
          mandatory: true 
          notNull: true
          
      - name: firstName
        type: String
        constraints:
          mandatory: true 
          notNull: true

      - name: lastName
        type: String
        constraints:
          mandatory: true 
          notNull: true

  - type: CreateIndex
    className: User
    name: User.username
    type: Unique
    properties: [username]

  - type: CreateIndex
    className: User
    name: User.email
    type: Unique
    properties: [email]
    
########## UserCredential Class ##########

  - type: CreateClass
    name: UserCredential
    properties: 
      - name: user
        type: Link
        classType: User
        constraints:
          mandatory: true 
          notNull: true

      - name: password
        type: String
        constraints:
          mandatory: true 
          notNull: true
          
  - type: CreateIndex
    className: UserCredential
    name: UserCredential.user
    type: Unique
    properties: [user]
    
########## UserAuthToken Class ##########

  - type: CreateClass
    name: UserAuthToken
    properties: 
      - name: user
        type: Link
        classType: User
        constraints:
          mandatory: true 
          notNull: true

      - name: token
        type: String
        constraints:
          mandatory: true 
          notNull: true
          
      - name: expireTime
        type: DateTime
        constraints:
          mandatory: true 
          notNull: true
          
########## Domain Class ##########

  - type: CreateClass
    name: Domain
    properties: 
      - name: namespace
        type: String
        constraints:
          mandatory: true 
          notNull: true
          
      - name: domainId
        type: String
        constraints: 
          mandatory: true
          notNull: true
          
      - name: displayName
        type: String
        constraints: 
          mandatory: true
          
      - name: owner
        type: Link
        classType: User
        constraints: 
          mandatory: true
          notNull: true
          
      - name: dbName
        type: String

      - name: dbUsername
        type: String
        
      - name: dbPassword
        type: String

      - name: status
        type: String
        constraints: 
          mandatory: true
          notNull: true
          
  - type: CreateIndex
    className: Domain
    name: Domain.dbName
    type: Unique
    properties: [dbName]

  - type: CreateIndex
    className: Domain
    name: Domain.namespace_domainId
    type: UniqueHashIndex
    properties: [namespace, domainId]
    
########## Registration Class ##########

  - type: CreateClass
    name: Registration
    properties: 
      - name: email
        type: String
        constraints:
          mandatory: true 
          notNull: true
          
      - name: fname
        type: String
        constraints: 
          mandatory: true
          notNull: true
          
      - name: lname
        type: String
        constraints: 
          mandatory: true
          notNull: true
          
      - name: reason
        type: String
        constraints: 
          mandatory: true
          notNull: true
          
      - name: token
        type: String
        constraints: 
          mandatory: true
          notNull: true
          
      - name: approved
        type: Boolean
        constraints: 
          mandatory: true
          notNull: true
          
  - type: CreateIndex
    className: Registration
    name: Registration.email
    type: Unique
    properties: [email]

  - type: CreateIndex
    className: Registration
    name: Registration.email_token
    type: Unique
    properties: [email, token]
    